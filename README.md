# **Embedded Systems Labs**
Лабораторные работы по дисциплине встраиваемые системы

## Лабораторная работа №1 работа с SPI и P10 Led Board

В ходе данной работы необходимо написать программу для управления положения круга, нарисованного на светодиодной панели, по средством наклонна панели по осям Ox и Oy
на базе микроконтроллера серии STMicroelectronics. Измерение наклона по осям происходит при помощи МЭМС гироскопа/акселерометра. 

Для выполнения задания необходимо изучить устройство МЭМС гироскопа и его подключения, принцип работы интерфейса SPI и связи по нему 
со светодиодной панелью P10 с размерностью 16x32 пикселей.

### Serial Peripheral Interface - SPI
**Serial Peripheral Interface**, **SPI — последовательный синхронный стандарт передачи данных,
предназначенный для обеспечения простого и недорогого высокоскоростного сопряжения микроконтроллеров и периферии.

В SPI используются четыре цифровых сигнала:

* **MOSI** — выход ведущего, вход ведомого. Служит для передачи данных от ведущего устройства ведомому.

* **MISO** — вход ведущего, выход ведомого. Служит для передачи данных от ведомого устройства ведущему.

* **SCLK** или **SCK** — последовательный тактовый сигнал. Служит для передачи тактового сигнала для ведомых устройств.

* **CS** или **SS** — выбор микросхемы, выбор ведомого.

#### Прием и передача данных в SPI
Передача осуществляется пакетами. Длина пакета, как правило, составляет 1 байт (8 бит),
при этом известны реализации SPI с иной длиной пакета, например, 4 бита.
Ведущее устройство инициирует цикл связи установкой
низкого уровня на выводе выбора подчиненного устройства (SS)
того устройства, с которым необходимо установить соединение.

При низком уровне сигнала SS:

* схемотехника ведомого устройства находится в активном состоянии;
* вывод **MISO** переводится в режим «выход»;
* тактовый сигнал **SCLK** от ведущего устройства
воспринимается ведомым и вызывает считывание
на входе MOSI значений передаваемых от ведущего
битов и сдвиг регистра ведомого устройства.

Подлежащие передаче данные ведущее и ведомое устройства помещают
в сдвиговые регистры. После этого ведущее устройство начинает
генерировать импульсы синхронизации на линии **SCLK**, что приводит
к взаимному обмену данными. Передача данных осуществляется бит
за битом от ведущего по линии **MOSI** и от ведомого по линии **MISO**.
Передача осуществляется, как правило, начиная со старших битов,
но некоторые производители допускают изменение порядка передачи
битов программными методами. После передачи каждого пакета данных
ведущее устройство, в целях синхронизации ведомого устройства,
может перевести линию **SS** в высокое состояние.

[![img.png](images/img_int.png)](https://commons.wikimedia.org/wiki/File:SPI_8-bit_circular_transfer.svg?uselang=ru)

#### Преимущества и недостатки интерфейса SPI
##### Преимущества:
* Более высокая пропускная способность по сравнению с I²C или SMBus.
* Возможность произвольного выбора длины пакета.
* более низкие требования к энергопотреблению по сравнению с I²C и SMBus;
* ведомым устройствам не нужен уникальный адрес, в отличие от таких интерфейсов, как I²C, GPIB или SCSI.
* Используется только четыре вывода, что гораздо меньше, чем для параллельных интерфейсов.
* Максимальная тактовая частота ограничена только быстродействием устройств, участвующих в обмене данными.

##### Недостатки
* Необходимо больше выводов, чем для интерфейса **I²C**.
* Ведомое устройство не может управлять потоком данных.
* Нет подтверждения приема данных со стороны ведомого устройства.
* По дальности передачи данных интерфейс **SPI** уступает таким стандартам, как **UART** и **CAN**.

### Устройство LEDP10 Светодиодной панели
**P10 Светодиодная панель** или **P10 Led Board** представляет собой
панель состоящую из корпуса, светодиодов и управляющих микросхем.
Размерность светодиодной панели в пикселях равна 16 по высоте и
32 по ширине. Управление светодиодной панелью осуществляется
через интерфейс SPI, что позволяет подключать несколько панелей
последовательно и масштабиовать размерность панели.


**Результат работы:**
https://github.com/lazy-santa/Embedded-System-Labs/assets/84825600/ca1bf0a2-ff5e-4ea2-8913-32cd5d8449d6
